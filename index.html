<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Starlight React Native + StyleSheet Demo</title>
  <style>
    body {
      font-family: "Segoe UI", sans-serif;
      margin: 20px;
      background: #f4f6f8;
    }

    h1 {
      text-align: center;
      margin-bottom: 30px;
    }

    /* Basic fallback for custom tags */
    UIContainer, UIHeader, UILabel, UIButton, UITitle {
      display: block;
    }

    UIButton {
      cursor: pointer;
    }

    pre {
      background: #f0f0f0;
      padding: 12px;
      border-radius: 6px;
      font-size: 13px;
      overflow-x: auto;
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>Starlight React Native + StyleSheet Demo</h1>

  <div id="app"></div>

  <div>
    <h2>Compiled DSL</h2>
    <pre id="compiled"></pre>
  </div>

  <script type="module">
    import HTMLCompiler from "./html-compiler.js";
    import Starlight, { createElement, render, StyleSheet } from "./compiler.js";

    // -------------------------------
    // Define StyleSheet
    // -------------------------------
    const styles = StyleSheet({
      container: {
        padding: "20px",
        borderRadius: "10px",
        backgroundColor: "#e3f2fd",
        marginBottom: "10px"
      },
      header: {
        fontSize: "20px",
        fontWeight: "bold",
        marginBottom: "8px"
      },
      text: {
        fontSize: "16px",
        marginBottom: "6px"
      },
      button: {
        padding: "8px 14px",
        backgroundColor: "#2196F3",
        color: "white",
        borderRadius: "6px",
        margin: "4px 2px"
      }
    });

    // -------------------------------
    // DSL Code that uses the StyleSheet
    // -------------------------------
    const dslCode = `
UIContainer style={styles.container} {
  UIHeader style={styles.header} "Welcome to Starlight"
  UIContainer style={styles.container} {
    UILabel style={styles.text} "This is a React Native-like DSL"
    UIButton style={styles.button} "Click Me"
    UIButton style={styles.button} "Another Button"
  }
}
    `;

    // -------------------------------
    // Compile DSL to JS
    // -------------------------------
    const compiler = new HTMLCompiler();
    const compiledCode = compiler.compile(dslCode);
    document.getElementById("compiled").textContent = compiledCode;

    // -------------------------------
    // Render DSL
    // -------------------------------
    const appRoot = document.getElementById("app");

    // Use Function constructor to pass styles into DSL
    const fn = new Function("createElement", "styles", `return ${compiledCode}`);
    const vnode = fn(Starlight.createElement, styles);

    render(vnode, appRoot);
  </script>
</body>
</html>
