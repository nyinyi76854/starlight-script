<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Starlight Build Tool</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    textarea { width: 100%; height: 300px; }
    button { padding: 10px 20px; margin-top: 10px; }
  </style>
</head>
<body>

<h1>Starlight Builder</h1>

<p>
  This page will fetch your four source files from GitHub, combine them into one file,
  and let you download the result as <strong>starlight.js</strong>.
</p>

<textarea id="output" placeholder="Generated code will appear here..."></textarea><br>

<button id="buildBtn">Build starlight.js</button>
<button id="downloadBtn" disabled>Download starlight.js</button>

<script>
(async function() {
  // Edit these paths for your repo
  const baseURL = "https://raw.githubusercontent.com/nyinyi76854/starlight-script/main/";

  const files = [
    "src/syntax.js",
    "src/core/parser.js",
    "src/core/runtime.js",
    "src/index.js"
  ];

  const buildBtn = document.getElementById("buildBtn");
  const downloadBtn = document.getElementById("downloadBtn");
  const output = document.getElementById("output");

  let combinedCode = "";

  // Helper to fetch raw file text
  async function fetchFile(path) {
    const url = baseURL + path;
    const res = await fetch(url);
    if (!res.ok) throw new Error("Failed to fetch " + path);
    return await res.text();
  }

  buildBtn.onclick = async () => {
    try {
      output.value = "Fetching files...";
      combinedCode = "";

      for (const f of files) {
        const txt = await fetchFile(f);
        combinedCode += "\n\n// --- " + f + " ---\n" + txt;
      }

      output.value = combinedCode;
      downloadBtn.disabled = false;
    } catch (e) {
      output.value = "Error: " + e.message;
    }
  };

  downloadBtn.onclick = () => {
    const blob = new Blob([combinedCode], { type: "text/javascript" });
    const url = URL.createObjectURL(blob);
    const a = document.createElement("a");
    a.href = url;
    a.download = "starlight.js";
    a.click();
    URL.revokeObjectURL(url);
  };
})();
</script>

</body>
</html>
