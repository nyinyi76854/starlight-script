<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Android-like DSL Test</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    textarea { width: 100%; height: 150px; }
    pre { background: #f4f4f4; padding: 10px; overflow-x: auto; }
    #rendered { border: 1px solid #ccc; padding: 10px; margin-top: 10px; }
    button { margin-top: 5px; }
  </style>
</head>
<body>

<h2>Starlight Code</h2>
<textarea id="dslInput">
Screen {
  Header {
    Title "Hello, {username}"
  }

  Button onClick=handleClick {
    Text "Click me ({clickCount})"
  }

  Input placeholder="Type here" value={inputValue}
}
</textarea>
<button id="compileBtn">Compile & Render</button>

<h2>Compiled JS</h2>
<pre id="compiledJS"></pre>

<h2>Rendered Output</h2>
<div id="rendered"></div>

<script type="module">
  import HTMLCompiler, { createElement } from './html-compiler.js';
  import CompilerRuntime, { render, signal } from './compiler.js';

  const [username, setUsername] = signal("Alice");
  const [clickCount, setClickCount] = signal(0);
  const [inputValue, setInputValue] = signal("");

  window.handleClick = () => {
    setClickCount(clickCount() + 1);
  };

  document.getElementById("compileBtn").addEventListener("click", () => {
    const dsl = document.getElementById("dslInput").value;

    const compiler = new HTMLCompiler();
    const jsCode = compiler.compile(dsl);

    document.getElementById("compiledJS").textContent = jsCode;

    const AppVNode = eval(jsCode);

    const container = document.getElementById("rendered");
    render(AppVNode, container);
  });
</script>

</body>
</html>
